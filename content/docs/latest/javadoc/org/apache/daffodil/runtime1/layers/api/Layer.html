<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>Layer (Apache Daffodil 3.8.0 Java API)</title>
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Layer (Apache Daffodil 3.8.0 Java API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":6,"i12":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/ChecksumLayer.html" title="class in org.apache.daffodil.runtime1.layers.api"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/daffodil/runtime1/layers/api/Layer.html" target="_top">Frames</a></li>
<li><a href="Layer.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.daffodil.runtime1.layers.api</div>
<h2 title="Class Layer" class="title">Class Layer</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.daffodil.runtime1.layers.api.Layer</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd>org.apache.daffodil.runtime1.layers.ChecksumLayerBase</dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="typeNameLabel">Layer</span>
extends java.lang.Object</pre>
<div class="block">This is the primary API class for writing layers.
 <p>
 All layers are derived from this class.
 <p>
 This class is used directly as a base class to define <i>transforming</i> layers.
 To simplify the
 definition of <i>checksum</i> layers, a specialized sub-class
 <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/ChecksumLayer.html" title="class in org.apache.daffodil.runtime1.layers.api"><code>ChecksumLayer</code></a>
 is also available.
 Many of the requirements for layers, such as the naming conventions for layer variables,
 are described here, but they apply equally to checksum layers.
 <p>
 Derived classes will be dynamically loaded by Java's Service Provider Interface (SPI) system.
 The names of concrete classes derived from Layer are listed in
 a metadata resource file
 named for this class (that is, the file name is the fully-qualified class name of this class:
 <code>resources/META-INF/services/org.apache.daffodil.runtime1.layers.api.Layer</code>).
 This file contains lines where each line contains one fully qualified class name of a derived
 layer class.
 More than one line in the file denotes that the Jar file contains the definitions of more than one derived layer
 class.
 This file is incorporated in the compiled jar file for the derived <code>Layer</code> class
 so that the class path can be searched and Jars containing layer classes can be dynamically loaded.
 <p>
 The SPI creates an instance the class by calling a default (no-arg) constructor, which should be
 the only constructor.
 <p>
 Instances of derived layer classes can be stateful.
 They are private to threads, and each time a layer
 is encountered during parse/unparse, an instance is created for that situation.
 <p>
 Layer instances should not share mutable state (such as via singleton objects).
 <p>
 <h2>About Layer Variables</h2>
 <p>
 Layer logic may read and write DFDL variables.
 These variables are associated with the layer implementation class by using
 Java/Scala reflection to find matches (case-sensitive) between the names of DFDL variables and method
 names and method arguments of the layer's Java/Scala code.
 Hence, the layer's DFDL variables must have names suitable for use as Java/Scala
 identifiers.
 <p>
 The layer namespace is used only for its layer.
 All DFDL variables defined in that namespace are either used to pass parameters to the
 layer code, or receive results (such as a checksum) back from the layer code.
 This is enforced.
 If a layer namespace contains a DFDL variable and there is no corresponding
 usage of that variable name in the layer code (following the conventions below), then
 it is a Schema Definition Error when the layer code is loaded.
 <p>
 A layer that does not define any DFDL variables does
 not have to define a DFDL schema that defines the layer's target
 namespace, but any layer that uses DFDL variables *must* define a
 schema with the layer's namespace as its target namespace, and with the
 variables declared in it (using <code>dfdl:defineVariable</code>).
 </p>
 Every DFDL Variable in the layer's target namespace is used either at the start of the
 layer algorithm as a parameter to the layer or at the end of the layer algorithm where it is
 assigned a return value (such as a checksum or flag) from the layer.
 <p>
 Variables being read must have values before being read by the layer, and this is true for both
 parsing and unparsing.
 This happens when the Daffodil processor begins parsing/unparsing the layered sequence.
 When unparsing, variables being read cannot be forward-referencing to parts
 of the DFDL infoset that have not yet been unparsed.
 <p>
 A layer that wants to read parameters declares a special setter named
 <code>setLayerVariableParameters</code>
 which has arguments where each has a name and type that match a corresponding
 <code>dfdl:defineVariable</code> in the layer's target namespace.
 <p>
 For example, if the layer logic has a DFDL variable for a parameter named <code>direction</code>
 of type <code>xs:string</code> and another DFDL variable for a parameter named <code>wordCount</code>
 of type <code>xs:unsignedShort</code>
 then the derived Layer class must have a <code>setLayerVariableParameters</code> with
 arguments corresponding in name and type to these two variables.
 This setter will be called passing the value of the variables immediately after the layer
 instance is constructed.
 The arguments to <code>setLayerVariableParameters</code> can be in any order:
 <pre>
     void setLayerVariableParameters(String direction, int wordCount) {
         // usually this setter will assign the values to data members
         this.direction = direction;
         this.wordCount = wordCount;
     }
 </pre>
 Beside initializing local members, this setter is also an initializer for the layer class instance.
 Any exception thrown becomes a Schema Definition Error.
 <p>
 If there are no parameter variables, then this setter, with no arguments, can be used purely for initialization.
 <p>
 A DFDL variable used to return a result from a layer must be undefined, since variables in DFDL are single-assignment.
 Usually this means the use of the layer must be surrounded by a <code>dfdl:newVariableInstance</code>
 annotation which creates a new instance of the layer result variable, over a limited scope
 of use.
 The variable is assigned by the layer, and it is then available for reading by the DFDL schema until
 the end of the <code>dfdl:newVariableInstance</code> scope.
 <p>
 To return a value into a DFDL variable, the layer implementation defines a special recognizable
 getter method.
 The name of the getter is formed from prefixing the DFDL variable name with the string
 "<code>getLayerVariableResult_</code>".
 The return type of the getter must correspond to the type of the variable.
 <p>
 For example, a result value getter for a DFDL variable named <code>total</code> of type <code>xs:unsignedShort</code> would be:
 <pre>
 <code>
      int getLayerVariableResult_total() {
          // returns the value created by the layer's algorithm.
          // commonly this returns the value of a data member.
          return this.total;
      }
 </code>
 </pre>
 Layers could have multiple result variables, but a single variable is most common, generally for returning checksums.
 See the <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/ChecksumLayer.html" title="class in org.apache.daffodil.runtime1.layers.api"><code>ChecksumLayer</code></a> class, which is designed to facilitate creation of checksum/CRC/hash/digest layers.
 <p>
 The Java types to use for the setter arguments and getter return types correspond to the DFDL variable types
 according to this table:
 <table border="1">
     <tr>
         <th>DFDL Schema Type</th>
         <th>Java Type</th>
     </tr>
     <tr>
         <td>xs:byte</td>
         <td>byte</td>
     </tr>
     <tr>
         <td>xs:short</td>
         <td>short</td>
     </tr>
     <tr>
         <td>xs:int</td>
         <td>int</td>
     </tr>
     <tr>
         <td>xs:long</td>
         <td>long</td>
     </tr>
     <tr>
         <td>xs:integer</td>
         <td>java.math.BigInteger</td>
     </tr>
     <tr>
         <td>xs:decimal</td>
         <td>java.math.BigDecimal</td>
     </tr>
     <tr>
         <td>xs:unsignedInt</td>
         <td>long</td>
     </tr>
     <tr>
         <td>xs:unsignedByte</td>
         <td>short</td>
     </tr>
     <tr>
         <td>xs:unsignedShort</td>
         <td>int</td>
     </tr>
     <tr>
         <td>xs:unsignedLong</td>
         <td>java.math.BigInteger</td>
     </tr>
     <tr>
         <td>xs:nonNegativeInteger</td>
         <td>java.math.BigInteger</td>
     </tr>
     <tr>
         <td>xs:double</td>
         <td>double</td>
     </tr>
     <tr>
         <td>xs:float</td>
         <td>float</td>
     </tr>
     <tr>
         <td>xs:hexBinary</td>
         <td>byte[]</td>
     </tr>
     <tr>
         <td>xs:anyURI</td>
         <td>java.net.URI</td>
     </tr>
     <tr>
         <td>xs:boolean</td>
         <td>boolean</td>
     </tr>
     <tr>
         <td>xs:dateTime</td>
         <td>com.ibm.icu.util.ICUCalendar</td>
     </tr>
     <tr>
         <td>xs:date</td>
         <td>com.ibm.icu.util.ICUCalendar</td>
     </tr>
     <tr>
         <td>xs:time</td>
         <td>com.ibm.icu.util.ICUCalendar</td>
     </tr>
     <caption style="caption-side:bottom"></caption>
 </table>
 <p>
 <h2>Layer Algorithm</h2>
 <p>
 The rest of the Layer class implements the layer decode/encode logic.
 <p>
 The actual algorithm of the layer is not implemented in methods of the derived layer class, but rather is
 implemented in the layer's <i>input decoder</i> and <i>output encoder</i>.
 These extend the <code>java.io.InputStream</code> and <code>java.io.OutputStream</code> base classes to actually handle the
 data.
 <p>
 Every layer must implement the <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#wrapLayerInput-java.io.InputStream-"><code>wrapLayerInput(java.io.InputStream)</code></a> and <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#wrapLayerOutput-java.io.OutputStream-"><code>wrapLayerOutput(java.io.OutputStream)</code></a>
 methods, which provide the input decoder and output encoder instances to the Daffodil layer framework.
 When parsing/unparsing, the derived Layer class itself is concerned with setup and tear-down of the
 layer's input decoder and output encoder, with providing access to/from DFDL variables,
 and with reporting errors effectively.
 <p>
 <h3> Layer Exception Handling </h3>
 The method <code>setProcessingErrorException </code> allows the layer to specify that if the layer throws specific
 exceptions or runtime exceptions that they are converted into processing errors.
 This eliminates most need for layer code to contain try-catches.
 For example:
 <pre>
 <code>
     setProcessingErrorException(IOException.class);
 </code>
 </pre>
 informs the DFDL processor that an IOException thrown from the layer is to be treated as a processing error.
 <p>
 Unhandled exceptions thrown by the layer code are treated as fatal errors.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#Layer-java.lang.String-java.lang.String-">Layer</a></span>(java.lang.String&nbsp;localName,
     java.lang.String&nbsp;targetNamespace)</code>
<div class="block">Constructs a new Layer object with the given layer name and namespace URI.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>org.apache.daffodil.runtime1.layers.LayerRuntime</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#getLayerRuntime--">getLayerRuntime</a></span>()</code>
<div class="block">For framework use.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;java.lang.Class&lt;? extends java.lang.Exception&gt;&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#getProcessingErrorExceptions--">getProcessingErrorExceptions</a></span>()</code>
<div class="block">For framework use.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#localName--">localName</a></span>()</code>
<div class="block">For framework use.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#name--">name</a></span>()</code>
<div class="block">For framework use.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#namespace--">namespace</a></span>()</code>
<div class="block">For framework use.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#processingError-java.lang.String-">processingError</a></span>(java.lang.String&nbsp;msg)</code>
<div class="block">Use to report a processing error.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#processingError-java.lang.Throwable-">processingError</a></span>(java.lang.Throwable&nbsp;cause)</code>
<div class="block">Use to report a processing error.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#runtimeSchemaDefinitionError-java.lang.String-">runtimeSchemaDefinitionError</a></span>(java.lang.String&nbsp;msg)</code>
<div class="block">Use to report a runtime schema definition error.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#runtimeSchemaDefinitionError-java.lang.Throwable-">runtimeSchemaDefinitionError</a></span>(java.lang.Throwable&nbsp;cause)</code>
<div class="block">Use to report a runtime schema definition error.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#setLayerRuntime-org.apache.daffodil.runtime1.layers.LayerRuntime-">setLayerRuntime</a></span>(org.apache.daffodil.runtime1.layers.LayerRuntime&nbsp;lr)</code>
<div class="block">For framework use.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#setProcessingErrorException-java.lang.Class-">setProcessingErrorException</a></span>(java.lang.Class&lt;? extends java.lang.Exception&gt;&nbsp;e)</code>
<div class="block">Use to add an exception class to the list of exceptions that will be automatically converted
 into processing errors.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>abstract java.io.InputStream</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#wrapLayerInput-java.io.InputStream-">wrapLayerInput</a></span>(java.io.InputStream&nbsp;jis)</code>
<div class="block">Wraps a layer <i>input decoder</i> around an input stream.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>abstract java.io.OutputStream</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#wrapLayerOutput-java.io.OutputStream-">wrapLayerOutput</a></span>(java.io.OutputStream&nbsp;jos)</code>
<div class="block">Wraps a layer <i>output encoder</i> around an output stream.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Layer-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Layer</h4>
<pre>public&nbsp;Layer(java.lang.String&nbsp;localName,
             java.lang.String&nbsp;targetNamespace)</pre>
<div class="block">Constructs a new Layer object with the given layer name and namespace URI.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>localName</code> - the local NCName of the layer. Must be usable as a Java identifier.</dd>
<dd><code>targetNamespace</code> - the namespace URI of the layer. Must obey URI syntax.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if arguments are null or do not obey required syntax.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="name--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>name</h4>
<pre>public final&nbsp;java.lang.String&nbsp;name()</pre>
<div class="block">For framework use.
 <p>
 This method and the string it returns are required by the SPI loader.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A unique indentifier for the kind of layer. Contains both local and namespace components of the layer's complete name.</dd>
</dl>
</li>
</ul>
<a name="localName--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>localName</h4>
<pre>public final&nbsp;java.lang.String&nbsp;localName()</pre>
<div class="block">For framework use.</div>
</li>
</ul>
<a name="namespace--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>namespace</h4>
<pre>public final&nbsp;java.lang.String&nbsp;namespace()</pre>
<div class="block">For framework use.</div>
</li>
</ul>
<a name="setLayerRuntime-org.apache.daffodil.runtime1.layers.LayerRuntime-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setLayerRuntime</h4>
<pre>public final&nbsp;void&nbsp;setLayerRuntime(org.apache.daffodil.runtime1.layers.LayerRuntime&nbsp;lr)</pre>
<div class="block">For framework use.
 <p>
 Called by the execution framework to give the context for reporting errors.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>lr</code> - runtime data structure used by the framework</dd>
</dl>
</li>
</ul>
<a name="getLayerRuntime--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLayerRuntime</h4>
<pre>public final&nbsp;org.apache.daffodil.runtime1.layers.LayerRuntime&nbsp;getLayerRuntime()</pre>
<div class="block">For framework use.
 <p>
 Called by the execution framework to obtain the context for reporting errors.</div>
</li>
</ul>
<a name="processingError-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processingError</h4>
<pre>public&nbsp;void&nbsp;processingError(java.lang.String&nbsp;msg)</pre>
<div class="block">Use to report a processing error.
 <p>
 When parsing a processing error can cause backtracking so that the parse
 can often recover from the error.
 <p>
 When unparsing a processing error is fatal.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>msg</code> - describes the error</dd>
</dl>
</li>
</ul>
<a name="processingError-java.lang.Throwable-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processingError</h4>
<pre>public&nbsp;void&nbsp;processingError(java.lang.Throwable&nbsp;cause)</pre>
<div class="block">Use to report a processing error.
 <p>
 When parsing a processing error can cause backtracking so that the parse
 can often recover from the error.
 <p>
 When unparsing a processing error is fatal.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cause</code> - a throwable object that describes the error</dd>
</dl>
</li>
</ul>
<a name="runtimeSchemaDefinitionError-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>runtimeSchemaDefinitionError</h4>
<pre>public&nbsp;void&nbsp;runtimeSchemaDefinitionError(java.lang.String&nbsp;msg)</pre>
<div class="block">Use to report a runtime schema definition error.
 <p>
 This indicates that the layer is unable to
 work meaningfully because of the way it is configured.
 That is, the schema itself is not well defined due to
 the way the layer is configured.
 <p>
 For example suppose a layer had a DFDL variable for a parameter that is supposed
 to be an integer between 1 and 10, and this parameter is generally provided as a constant value.
 If the provided parameter variable value is 0, which is not meaningful, then a
 Runtime Schema Definition Error is the right error to invoke.
 <p>
 This error type is always fatal whether parsing or unparsing.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>msg</code> - describes the error</dd>
</dl>
</li>
</ul>
<a name="runtimeSchemaDefinitionError-java.lang.Throwable-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>runtimeSchemaDefinitionError</h4>
<pre>public&nbsp;void&nbsp;runtimeSchemaDefinitionError(java.lang.Throwable&nbsp;cause)</pre>
<div class="block">Use to report a runtime schema definition error.
 <p>
 This indicates that the layer is unable to
 work meaningfully because of the way it is configured. The schema itself is not well defined due to
 the way the layer is configured.
 <p>
 This error type is always fatal whether parsing or unparsing.
 See <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#runtimeSchemaDefinitionError-java.lang.String-"><code>runtimeSchemaDefinitionError(String)</code></a> for discussion of situations where
  a Runtime Schema Definition Error is appropriate.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cause</code> - a throwable object that describes the error</dd>
</dl>
</li>
</ul>
<a name="wrapLayerInput-java.io.InputStream-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>wrapLayerInput</h4>
<pre>public abstract&nbsp;java.io.InputStream&nbsp;wrapLayerInput(java.io.InputStream&nbsp;jis)
                                            throws java.lang.Exception</pre>
<div class="block">Wraps a layer <i>input decoder</i> around an input stream.
 <p>
 This input decoder does the real parser-time work of the layer.
 It implements <code>java.io.InputStream</code>, by
 reading data from the given argument input stream, and decoding it.
 <p>
 Any exception thrown from this wrap method becomes a Schema Definition Error (fatal).
 <p>
 The input decoder generally uses a reference to this layer instance to report errors.
 <p>
 To have the Daffodil layer framework convert uncaught exceptions
 thrown by the input decoder into processing errors automatically,
 call the <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#setProcessingErrorException-java.lang.Class-"><code>setProcessingErrorException(Class)</code></a>.
 Other kinds of input decoder processing errors can be signaled by calling the <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#processingError-java.lang.String-"><code>processingError(String)</code></a> or
 <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#processingError-java.lang.Throwable-"><code>processingError(Throwable)</code></a> methods.
 Input decoder schema definition errors are more rare, but if needed the <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#runtimeSchemaDefinitionError-java.lang.String-"><code>runtimeSchemaDefinitionError(String)</code></a> or
 <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#runtimeSchemaDefinitionError-java.lang.Throwable-"><code>runtimeSchemaDefinitionError(Throwable)</code></a> methods may be called.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>jis</code> - The input stream to be wrapped.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>An input stream with the layer's input decoder wrapped around it.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a name="wrapLayerOutput-java.io.OutputStream-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>wrapLayerOutput</h4>
<pre>public abstract&nbsp;java.io.OutputStream&nbsp;wrapLayerOutput(java.io.OutputStream&nbsp;jos)
                                              throws java.lang.Exception</pre>
<div class="block">Wraps a layer <i>output encoder</i> around an output stream.
 <p>
 The output encoder does the real unparse-time work of the layer.
 It implements <code>java.io.OutputStream</code> by
 accepting data via the usual output stream write calls, encoding this
 data, and writing the encoded data to the argument output stream.
 <p>
 Any exception thrown from this wrap method becomes a Schema Definition Error (fatal).
 <p>
 The output encoder generally uses a reference to this layer to report errors.
 <p>
 To have the Daffodil layer framework convert uncaught exceptions
 thrown by the output encoder into processing errors automatically,
 call the <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#setProcessingErrorException-java.lang.Class-"><code>setProcessingErrorException(Class)</code></a>.
 Other kinds of output encoder processing errors can be signaled by calling the <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#processingError-java.lang.String-"><code>processingError(String)</code></a> or
 <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#processingError-java.lang.Throwable-"><code>processingError(Throwable)</code></a> methods.
 Output encoder schema definition errors are more rare, but if needed the <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#runtimeSchemaDefinitionError-java.lang.String-"><code>runtimeSchemaDefinitionError(String)</code></a> or
 <a href="../../../../../../org/apache/daffodil/runtime1/layers/api/Layer.html#runtimeSchemaDefinitionError-java.lang.Throwable-"><code>runtimeSchemaDefinitionError(Throwable)</code></a> methods may be called.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>jos</code> - The output stream to be wrapped.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>An output stream with the layer wrapped around it.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a name="setProcessingErrorException-java.lang.Class-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setProcessingErrorException</h4>
<pre>public final&nbsp;void&nbsp;setProcessingErrorException(java.lang.Class&lt;? extends java.lang.Exception&gt;&nbsp;e)</pre>
<div class="block">Use to add an exception class to the list of exceptions that will be automatically converted
 into processing errors.
 <p>
 The purpose of this is to allow one to use java/scala libraries that may throw
 exceptions when encountering bad data. Such exceptions should be translated into
 processing errors, which will allow the parser to backtrack and try other alternatives
 which may work for that data.
 By calling this method the layer framework implements the try-catch logic to capture
 these exception types and convert them into processing errors.
 This avoids a great deal of try-catch logic that would otherwise be required in
 layer methods.
 <p>
 When considering whether a thrown Exception is to be converted to a processing error
 RuntimeException classes are handled separately from Exception classes.
 Hence calling
 <pre>
     setProcessingErrorException(Exception.class);
 </pre>
 will NOT cause all RuntimeExceptions to also be converted into processing errors.
 It will, however, cause all classes derived from Exception that are NOT RuntimeExceptions
 to be caught and converted into Processing Errors.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>e</code> - the exception class to be added to the list of processing error exceptions</dd>
</dl>
</li>
</ul>
<a name="getProcessingErrorExceptions--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getProcessingErrorExceptions</h4>
<pre>public final&nbsp;java.util.List&lt;java.lang.Class&lt;? extends java.lang.Exception&gt;&gt;&nbsp;getProcessingErrorExceptions()</pre>
<div class="block">For framework use.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/daffodil/runtime1/layers/api/ChecksumLayer.html" title="class in org.apache.daffodil.runtime1.layers.api"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/daffodil/runtime1/layers/api/Layer.html" target="_top">Frames</a></li>
<li><a href="Layer.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
